{% extends "base.html" %}
{% load dataset_tags %}
{% load url from future %}
{% load staticfiles %}
{% load crispy_forms_tags %}
{% block static %}
<!-- DataTables.net -->
<script type="text/javascript" src='{{ STATIC_URL }}datatables/media/js/jquery.dataTables.min.js'></script>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}datatables/media/css/jquery.dataTables.css">
<!-- DataTables.net Bootstrap integration -->
<script type="text/javascript" src="{{ STATIC_URL }}js/dataTables.bootstrap.js"></script>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/dataTables.bootstrap.css">
{% endblock static %}
{% block content %}
<div class="container">
  <h1 class="page-title center">
    <a href="#" id="datasetName">{{ dataset.name }}</a>
  </h1>

  <script>
  $('#datasetName').editable({
   type: 'text',
   pk: {{ dataset.pk }},
   url: '{% url 'datasets:update_name' dataset.pk %}',
   title: 'Edit dataset name'
 });
  </script>

  {# Dataset control buttons #}
  <div class="row">
    <div class="span12">
      <div class="btn-toolbar">
        <div class="btn-group">
          <a href="#addSourceForm" class="btn btn-primary"><i class="icon-plus-sign"></i> Add data</a>

          <a href="#datasetHeading" class="btn btn-primary"><i class="icon-table"></i> Table</a>
          <a data-toggle="collapse" href="#chart" class="btn btn-primary"><i class="icon-bar-chart"></i> Visualize</a>
        </div>
        <div class="btn-group pull-right">
          <a href="{% url 'datasets:edit' dataset.pk %}" class="btn btn-primary"><i class="icon-pencil"></i> Edit</a>

          <a href="{% url 'datasets:delete' dataset.pk %}" class="btn btn-primary"><i class="icon-remove"></i> Delete</a>
        </div>

      </div>
    </div>
  </div><!-- end row-->

  <div class="row">
    <div class="block span12">
      <div class="block-heading" data-toggle="collapse" href="#info">Information</div>
      <div id="info" class="collapse in">
        <table>
          <tbody>
            <tr>
              <th>Description</th>
              <td>  {{ dataset.description }}</td>
            </tr>
            <tr>
              <th>Species</th>
              <td><em> {{ dataset.species }} </em></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div><!-- end Information row-->


  {# Visualization and Control #}
  <div class="row">
    {# Visualization panel #}
    <div class="span9">
      <div class="block">
        <div id="visualization" class="block-heading" data-toggle="collapse" href="#chart">
          Visualization</div>
          <div id="chart" class="collapse out"></div>
        </div>
    </div>
      {# Axes control #}
      <div class="span3">
        <div class="span3">
          <center>
            <div class="block block-heading" data-toggle="collapse" href="#control">Axes</div>
            <div id="control" class="collapse out">
              <div class="btn-group btn-group-vertical" data-toggle="buttons-checkbox" style="margin-top:25px">
                {% for feature in feature_objects %}
                <button type="button" class="btn btn-primary feature-btn" value="{{ forloop.counter0 }}">
                  {% if feature.name == 'zcr' %}
                  {{ feature.name|upper }}
                  {% else %}
                  {{ feature.name|capfirst }}
                  {% endif %}
                </button>
                {% endfor %}
              </div>
            </div>
          </center>
        </div>
      </div><!--end span3 -->
    </div><!-- end row -->

    {% comment %}
    <div class="row">
      <div class="span12">
        <div class="btn-toolbar">
          <a href="{% url 'datasets:create_label' dataset.pk  %}" class="btn btn-info"><i class="icon-beaker"></i> Add Variable</a>
        </div>
      </div>
    </div><!-- end row-->
    {% endcomment %}
    <form action="{% url 'datasets:delete_instances' dataset.pk  %}" id="select_instances" method="post">{% csrf_token %}
      <div class="row">
        <div class="span12">
         <button type="submit"class="btn">
          <i class="icon-remove"></i> Delete selected instances
        </button>
      </div>
    </div>



    <div class="row">
      {% include "datasets/show_dataset.html" %}
    </div>
  </form>

  <div class="row">
    <div class="span12">
      {% crispy upload_form %}
    </div>
  </div>
  {% include "datasets/visualization.html" %}
  {% include "datasets/datatable.html" %}
</div>
{% endblock content %}