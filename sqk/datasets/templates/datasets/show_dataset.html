{% load url from future %}
<fieldset>
<div class="block span12">
  <div id="datasetHeading" class="block-heading" data-toggle="collapse" href="#dataset">Data</div>
  <div id="dataset" class="collapse in">
    <table id="dataset-table" class="table table-striped">
      {# Header #}
      <thead>
        <tr>
          {# Only show header if there are instances #}
          {% if dataset.instances.all %}
          <th rowspan="2"><input type="checkbox" class="checkall"></th>
          <th rowspan="2">#</th>
          {% for label_name in label_names %}
          <th rowspan="2"><i class="icon-beaker"></i><a href="#" class="label_name" id="label_name{{ label_name.pk }}"> {{ label_name|capfirst }}</a></th>
          <script>
            $('#label_name{{ label_name.pk }}').editable({
             type: 'text',
             showbuttons: false,
             pk: {{ label_name.pk }},
             url: '{% url 'datasets:update_label_name' dataset.pk label_name.pk  %}',
             value: '',
             title: 'Edit label name'
           });
          </script>
          {% endfor %}
          <th colspan="{{ feature_names|length }}" rowspan="1">Audio features</th>
        </tr>
        <tr>
          {% for feature_name in feature_names %}
          {% if feature_name == 'zcr' %}
              <th>{{ feature_name|upper }}</th>
          {% else %}
              <th>{{ feature_name|capfirst }}</th>
          {% endif %}
          {% endfor %}
          <th>Date added</th>
          {% endif %}
        </tr>
      </thead>

      {# Data #}
      <tbody>
        {% for inst in data %}
          <tr>
            <td>
              <input type="checkbox" name="instance_select{{ inst.pk }}" value="{{ inst.pk }}">
            </td>
            <td>{{ forloop.counter }}</td>

            {% if inst.labels %}
            {% for label_name, label_value in inst.labels.items %}
            <td><a href="#" id="instance_label_{{ inst.pk }}">{{ label_value }}</a></td>
            {# Initiate editable label value #}
            <script>
            $('#instance_label_{{ inst.pk }}').editable({
             type: 'text',
             showbuttons: false,
             pk: {{ inst.pk }},
             url: '{% url 'datasets:update_instance_label' inst.pk label_name.pk  %}',
             value: '',
             title: 'Edit instance label'
           });
            </script>
            {% endfor %}
            {% else %}
            <td>No label</td>
            {% endif %}
            {% for value in inst.values %}
            <td>{{ value|floatformat:3 }}</td>
            {% endfor %}
            <td>{{ inst.created_at|date:"m/d/Y f a" }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</fieldset>
<script>
</script>
